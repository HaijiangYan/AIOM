# Quick Start Guide

This guide shows the simplest way that will help you create and deploy your first experiment with AIOM in just a few minutes.

## Prerequisites

Firstly, make sure you have [node>=18](https://nodejs.org/en/download/prebuilt-installer) installed:

```bash
node -v
# or
nvm list  # if you have nvm installed on your machine
```

AIOM provides you the best work flow with Docker for local development and verification. Setup a postgresql database for local test with [Docker](https://docs.docker.com/get-started/get-docker/)
After installing and starting the docker desktop, in your CLI (terminal for MACOS/LINUX or WINDOWS powershell)
```bash
docker -v  # check if docker runs correctly
docker pull postgres:17.6-alpine  # get a psql image from docker hub, you can also choose another version of psql

# Start PostgreSQL container with AIOM configuration
docker run -d \
  --name aiom-postgres \
  -p 5432:5432 \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=aiom \
  -e POSTGRES_DB=aiom \
  postgres:17.6-alpine
# Verify the container is running
docker ps
```

Your PostgreSQL database is now running and accessible at (need to be aligned with .env):

- **Host**: localhost
- **Port**: 5432
- **Database**: aiom
- **Username**: postgres
- **Password**: aiom

```bash
# some useful command for docker

docker exec -it aiom-postgres psql -U postgres -d aiom -c "DROP SCHEMA public CASCADE; CREATE SCHEMA public;"  # Delete all data from the database
docker stop aiom-postgres  # Stop the database
docker start aiom-postgres  # Start the database (after stopping)
docker exec -it aiom-postgres psql -U postgres -d aiom  # Connect to PostgreSQL CLI
docker logs aiom-postgres  # View database logs
docker rm -f aiom-postgres  # Remove the container (when done testing)
```

## Creating a Simple study

Install AIOM on your device:
```bash
npm install -g aiom

# for mac/linux, you may need root authority by using sudo:
sudo npm install -g aiom
```

Then, see helps and create your first study
```bash
aiom help  # see basic usage. This line grabs the newest version of aiom temporally
aiom list  # see all available task templates
aiom create  # build new study directory in you current working directory
```

You will be prompted to input some key information to define your new study, including: 

- **`your_study_name`** - can be any name without spaces and hyphens.
- **`tasks_in_order`** - can be any task names splitted by '/' in order according to your design. If a task name is already existed in [demos](examples/template_list.md), then corresponding templates will be used for this task; if not, AIOM will initialize a simple template (categorization task) as base code for you to customize your task. For the first-time test, I advise you to input _categorization/a_customized_name_outside_templates_ to test the multi-task management, established demo and task custimization with AIOM in one run, without the need to build external endpoints serving your stimuli.
- **`participants_entrance`** - for now, just using prolific (automatically get participant_id from url) or not (participants input id manually). 
```bash
cd your_study_name  # set your study as CWD
npm install  # build dependencies
```

A typical study built by AIOM will be:

```
your_study_name/                        # Generated by 'npx aiom create'
â”œâ”€â”€ .env                                # Study-level configuration (backend)
â”œâ”€â”€ app.js                              # Starting script
â”œâ”€â”€ package.json                        # Dependencies
â”œâ”€â”€ .gitignore                     
â”œâ”€â”€ custom_text/                        # Customized text in study process
â”‚   â”œâ”€â”€ index.html                      # Entrance
â”‚   â”œâ”€â”€ consent.html                    # consent form
â”‚   â”œâ”€â”€ pinfo.html                      # Information for participants
â”‚   â”œâ”€â”€ introduction.html               # Overall introduction of the study
â”‚   â”œâ”€â”€ early_stop.js                   # Stop the study half-way through under some condition (e.g., attention check failure)
â”‚   â”œâ”€â”€ debrief.js                      # Debrief after the entire study
â”‚   â””â”€â”€ error.js                        # Tech issue occurs
â””â”€â”€ tasks/                              # Tasks defined in .env for this study
    â”œâ”€â”€ categorization/                 # Task 1
    â”‚   â”œâ”€â”€ controller.js               # Task-level configuration and functions (backend)
    â”‚   â”œâ”€â”€ custom_text/                   
    â”‚   â”‚   â””â”€â”€ instruction.html        # Instruction for task 1
    â”‚   â”œâ”€â”€ public/                     # Web assets (frontend)
    â”‚   â”‚   â”œâ”€â”€ experiment.ejs          # Interface
    â”‚   â”‚   â””â”€â”€ static/                 
    â”‚   â”‚       â”œâ”€â”€ experiment.js       # Interactive logics for task 1
    â”‚   â”‚       â””â”€â”€ experiment.css      # Style of the interface
    â”‚   â”œâ”€â”€ stimuli/                    # (optional) Stimuli used in the task
    â”‚   â”œâ”€â”€ utils/                      # (optional) Customized modules
    â”‚   â””â”€â”€ README.txt                  # Task 1 documentation
    â””â”€â”€ your_customized_name/           # Task 2
        â”œâ”€â”€ controller.js               # Task-level configuration and functions (backend)
        â”œâ”€â”€ custom_text/                   
        â”‚   â””â”€â”€ instruction.html           
        â”œâ”€â”€ public/                       
        â”‚   â”œâ”€â”€ experiment.ejs            
        â”‚   â””â”€â”€ static/                   
        â”‚       â”œâ”€â”€ experiment.js         
        â”‚       â””â”€â”€ experiment.css       
        â”œâ”€â”€ stimuli/                     
        â”œâ”€â”€ utils/                       
        â””â”€â”€ README.txt                   
```

Key Files/Directories for you to customize

- **`.env`** - Defining key configurations of the study (e.g., participant recruitment, bonus, task sequence)
- **`tasks/`** - Each subdirectory represents a task in your experiment sequence
- **`tasks/your_task/controller.js`** - Backend of your task, defining key parameters of your task
- **`tasks/your_task/public/`** - Frontend of your task, defining interactions of your task

If you wish, you can always add more task templates to your study using:
```bash
aiom add TASK_NAME  # the corresponding template will be automatically added to ./tasks
```

After all, give it a go
```bash
aiom run
```

You will see 
```
ğŸŒ Test your task: http://localhost:3000
ğŸ” View task data: http://localhost:3000/admin/db
```

To download the local experiment data from Docker psql container in currect working directory as .csv:
```bash
aiom download
```

(Optional) To deploy the study online (on heroku) after debugging, to make it public accessible: 
```bash
aiom heroku  # see integration functions with Heroku
```

You will need to set up a heroku account and install heroku's CLI tool in advance. [link](https://devcenter.heroku.com/articles/heroku-cli#install-the-heroku-cli)
You will be asked to provide API key for prolific if you recruit from prolific.

**Explore it and Enjoy!**

## âš™ï¸ More Advanced Functions

- **For More Task Templates**: [Templates](examples/template_list.md)
- **For Built-in Methods to customize your own task**: [APIs](api-reference.md)
Note: These two ways are not mutually exclusive, so you can start with a established template and then customize it with provided APIs.